<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Homelab ‚Äî Crystal Cavern</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500&family=Source+Code+Pro:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --void: #060612;
        --blue: #38bdf8;
        --teal: #2dd4bf;
        --white: #f0f0ff;
        --deep-teal: #0f766e;
        --seafoam: #5eead4;
        --glass: rgba(56, 189, 248, 0.04);
        --glass-hover: rgba(56, 189, 248, 0.08);
        --glass-border: rgba(56, 189, 248, 0.1);
        --glass-border-hover: rgba(56, 189, 248, 0.22);
        --text: rgba(240, 240, 255, 0.92);
        --text-mid: rgba(200, 200, 240, 0.55);
        --text-dim: rgba(160, 160, 220, 0.32);
      }

      *,
      *::before,
      *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        background: var(--void);
        color: var(--text);
        font-family: "Source Code Pro", monospace;
        font-weight: 400;
        font-size: 13px;
        min-height: 100vh;
        overflow-x: hidden;
      }

      /* === CRYSTAL BACKGROUND === */
      .cavern-bg {
        position: fixed;
        inset: 0;
        z-index: 0;
        overflow: hidden;
      }

      .cave-blob {
        position: absolute;
        border-radius: 50%;
        filter: blur(100px);
        opacity: 0.35;
        will-change: transform;
      }
      .cb1 {
        width: 600px;
        height: 500px;
        background: radial-gradient(
          ellipse,
          rgba(15, 118, 110, 0.4),
          transparent 70%
        );
        top: -12%;
        left: -8%;
        animation: cdrift-a 18s ease-in-out infinite alternate;
      }
      .cb2 {
        width: 500px;
        height: 500px;
        background: radial-gradient(
          ellipse,
          rgba(56, 189, 248, 0.15),
          transparent 70%
        );
        top: 35%;
        right: -10%;
        animation: cdrift-b 22s ease-in-out infinite alternate;
      }
      .cb3 {
        width: 550px;
        height: 400px;
        background: radial-gradient(
          ellipse,
          rgba(45, 212, 191, 0.12),
          transparent 70%
        );
        bottom: -8%;
        left: 25%;
        animation: cdrift-a 15s ease-in-out infinite alternate;
        animation-delay: -5s;
      }

      @keyframes cdrift-a {
        from { transform: translate(0, 0) scale(1); }
        to { transform: translate(50px, 35px) scale(1.1); }
      }
      @keyframes cdrift-b {
        from { transform: translate(0, 0) scale(1); }
        to { transform: translate(-40px, 50px) scale(1.08); }
      }

      /* Crystal shards */
      .crystal-shard {
        position: absolute;
        opacity: 0.2;
        animation: crystal-pulse ease-in-out infinite alternate;
      }
      @keyframes crystal-pulse {
        from { opacity: 0.12; transform: scale(0.98); }
        to { opacity: 0.35; transform: scale(1.02); }
      }

      .shard-1 {
        width: 50px; height: 180px;
        background: linear-gradient(180deg, rgba(56, 189, 248, 0.4), transparent);
        clip-path: polygon(50% 0%, 100% 35%, 85% 100%, 15% 100%, 0% 35%);
        top: 5%; left: 2%; transform: rotate(-12deg);
        animation-duration: 5s;
      }
      .shard-2 {
        width: 40px; height: 140px;
        background: linear-gradient(180deg, rgba(45, 212, 191, 0.35), transparent);
        clip-path: polygon(50% 0%, 100% 40%, 80% 100%, 20% 100%, 0% 40%);
        top: 15%; right: 3%; transform: rotate(8deg);
        animation-duration: 7s; animation-delay: -2s;
      }
      .shard-3 {
        width: 60px; height: 200px;
        background: linear-gradient(0deg, rgba(56, 189, 248, 0.3), transparent);
        clip-path: polygon(50% 100%, 100% 65%, 85% 0%, 15% 0%, 0% 65%);
        bottom: 0; left: 8%; transform: rotate(5deg);
        animation-duration: 6s; animation-delay: -1s;
      }
      .shard-4 {
        width: 35px; height: 120px;
        background: linear-gradient(0deg, rgba(45, 212, 191, 0.3), transparent);
        clip-path: polygon(50% 100%, 100% 60%, 80% 0%, 20% 0%, 0% 60%);
        bottom: 0; right: 12%; transform: rotate(-7deg);
        animation-duration: 4s; animation-delay: -3s;
      }
      .shard-5 {
        width: 45px; height: 160px;
        background: linear-gradient(180deg, rgba(15, 118, 110, 0.5), transparent);
        clip-path: polygon(50% 0%, 100% 30%, 90% 100%, 10% 100%, 0% 30%);
        top: 40%; left: 0; transform: rotate(-20deg);
        animation-duration: 8s; animation-delay: -4s;
      }
      .shard-6 {
        width: 55px; height: 190px;
        background: linear-gradient(0deg, rgba(56, 189, 248, 0.25), transparent);
        clip-path: polygon(50% 100%, 100% 70%, 75% 0%, 25% 0%, 0% 70%);
        bottom: 5%; left: 45%; transform: rotate(3deg);
        animation-duration: 6s; animation-delay: -2s;
      }

      /* Floating crystals */
      .crystal-container {
        position: fixed; inset: 0; z-index: 1;
        pointer-events: none; overflow: hidden;
      }
      .crystal-particle {
        position: absolute; opacity: 0;
        animation: crystal-float linear infinite;
      }
      @keyframes crystal-float {
        0% { opacity: 0; transform: translateX(-100px) translateY(var(--yoff, 0px)) rotate(0deg); }
        10% { opacity: 0.6; }
        80% { opacity: 0.3; }
        100% { opacity: 0; transform: translateX(calc(100vw + 100px)) translateY(calc(var(--yoff, 0px) + var(--ydrift, 30px))) rotate(360deg); }
      }

      /* === HEADER === */
      header {
        position: relative; z-index: 10;
        padding: 22px 32px 18px;
        display: flex; justify-content: space-between; align-items: flex-end;
        border-bottom: 1px solid var(--glass-border);
        backdrop-filter: blur(14px);
      }
      .logo-label {
        font-size: 9px; letter-spacing: 5px; color: var(--blue);
        text-transform: uppercase; margin-bottom: 4px; opacity: 0.7;
      }
      .logo-name {
        font-family: "Spectral", serif; font-style: italic; font-weight: 500;
        font-size: 40px; line-height: 1; letter-spacing: 1px;
        background: linear-gradient(135deg, var(--blue), var(--teal), var(--white));
        -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
      }

      .pills { display: flex; gap: 7px; flex-wrap: wrap; justify-content: flex-end; }
      .pill {
        display: flex; align-items: center; gap: 5px;
        padding: 4px 11px; border-radius: 100px; font-size: 10px;
        border: 1px solid var(--glass-border); background: var(--glass);
        backdrop-filter: blur(10px);
      }
      .pill-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
      .pd-b { background: var(--blue); box-shadow: 0 0 8px var(--blue); animation: pulse-d 2.5s ease-in-out infinite; }
      .pd-t { background: var(--teal); box-shadow: 0 0 8px var(--teal); }
      .pd-w { background: var(--white); box-shadow: 0 0 8px rgba(240, 240, 255, 0.5); }
      @keyframes pulse-d {
        0%, 100% { box-shadow: 0 0 4px var(--blue); }
        50% { box-shadow: 0 0 14px var(--blue), 0 0 24px rgba(56, 189, 248, 0.4); }
      }
      .pill-label { color: var(--text-mid); }

      /* === MAIN GRID === */
      main {
        position: relative; z-index: 10;
        padding: 22px 32px;
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 14px;
        max-width: 1440px; margin: 0 auto;
      }

      /* === CARDS === */
      .card {
        background: var(--glass);
        border: 1px solid var(--glass-border);
        border-radius: 4px;
        backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
        position: relative; overflow: hidden;
        display: flex; flex-direction: column;
        transition: all 0.35s cubic-bezier(0.22, 1, 0.36, 1);
        animation: rise 0.7s cubic-bezier(0.22, 1, 0.36, 1) both;
      }
      .card:hover {
        background: var(--glass-hover);
        border-color: var(--glass-border-hover);
        transform: translateY(-3px);
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(56, 189, 248, 0.08);
      }

      /* Refraction streak on hover */
      .card::before {
        content: ""; position: absolute; inset: 0; z-index: 3; pointer-events: none;
        background: linear-gradient(115deg, transparent 35%, rgba(240, 240, 255, 0.08) 45%, rgba(56, 189, 248, 0.05) 50%, transparent 55%);
        background-size: 300% 100%; background-position: 200% 0;
        transition: background-position 0.6s ease;
      }
      .card:hover::before { background-position: -100% 0; }

      /* Top accent */
      .card-blue::after {
        content: ""; position: absolute; top: 0; left: 0; right: 0; height: 1px; z-index: 4;
        background: linear-gradient(90deg, transparent, var(--blue), transparent); opacity: 0.8;
      }
      .card-teal::after {
        content: ""; position: absolute; top: 0; left: 0; right: 0; height: 1px; z-index: 4;
        background: linear-gradient(90deg, transparent, var(--teal), transparent); opacity: 0.7;
      }

      .card:nth-child(1) { animation-delay: 0.05s; }
      .card:nth-child(2) { animation-delay: 0.1s; }
      .card:nth-child(3) { animation-delay: 0.15s; }
      .card:nth-child(4) { animation-delay: 0.2s; }
      .card:nth-child(5) { animation-delay: 0.25s; }
      .card:nth-child(6) { animation-delay: 0.3s; }
      .card:nth-child(7) { animation-delay: 0.35s; }

      @keyframes rise {
        from { opacity: 0; transform: translateY(22px) scale(0.98); }
        to { opacity: 1; transform: translateY(0) scale(1); }
      }

      .card-header {
        padding: 14px 16px 12px;
        display: flex; justify-content: space-between; align-items: center;
        border-bottom: 1px solid var(--glass-border);
        cursor: grab; user-select: none;
      }
      .card-header:active { cursor: grabbing; }
      .card-title {
        font-family: "Spectral", serif; font-style: italic; font-weight: 500;
        font-size: 16px; color: var(--text); letter-spacing: 0.5px;
        pointer-events: none;
      }
      .card-badge {
        font-size: 8px; letter-spacing: 2px; text-transform: uppercase;
        padding: 2px 8px; border-radius: 2px; border: 1px solid currentColor;
        pointer-events: none;
      }
      .badge-b { color: var(--blue); }
      .badge-t { color: var(--teal); }
      .badge-w { color: var(--white); }
      .card-body { padding: 14px 16px; flex: 1; display: flex; flex-direction: column; }

      /* Drag handle indicator */
      .drag-handle {
        display: flex; gap: 2px; flex-direction: column; margin-right: 8px;
        opacity: 0.25; transition: opacity 0.2s; pointer-events: none;
      }
      .card-header:hover .drag-handle { opacity: 0.6; }
      .drag-handle span {
        display: block; width: 12px; height: 2px; border-radius: 1px;
        background: var(--text-mid);
      }

      .card-title-wrap {
        display: flex; align-items: center; pointer-events: none;
      }

      /* Drag states */
      .card.dragging {
        opacity: 0.4; transform: scale(0.96); z-index: 1;
        box-shadow: none;
      }
      .card.drag-over {
        border-color: var(--teal);
        box-shadow: 0 0 20px rgba(45, 212, 191, 0.15), inset 0 0 20px rgba(45, 212, 191, 0.05);
      }
      .card.drag-ghost {
        position: fixed; z-index: 1000; pointer-events: none;
        opacity: 0.85; transform: rotate(1.5deg) scale(1.02);
        box-shadow: 0 30px 80px rgba(0, 0, 0, 0.6), 0 0 0 1px rgba(45, 212, 191, 0.2);
        transition: none; animation: none;
      }

      /* === STAT CELLS === */
      .stats-2x2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; flex: 1; grid-template-rows: 1fr 1fr; }
      .sc {
        background: rgba(56, 189, 248, 0.03); border: 1px solid var(--glass-border);
        border-radius: 4px; padding: 12px 10px; text-align: center;
        position: relative; overflow: hidden;
        display: flex; flex-direction: column; justify-content: center;
        transition: transform 0.2s, box-shadow 0.2s;
      }
      .sc:hover { transform: scale(1.03); box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3); }
      .sc::after {
        content: ""; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%);
        width: 50px; height: 24px; border-radius: 50%; filter: blur(16px);
        opacity: 0.35; background: var(--cg, var(--blue));
      }
      .cg-b { --cg: var(--blue); }
      .cg-t { --cg: var(--teal); }
      .cg-s { --cg: var(--seafoam); }
      .sc-nm { font-size: 7px; letter-spacing: 3px; text-transform: uppercase; color: var(--text-dim); margin-bottom: 5px; }
      .sc-val { font-family: "Spectral", serif; font-size: 32px; line-height: 1; }
      .sv-b { color: var(--blue); text-shadow: 0 0 18px rgba(56, 189, 248, 0.5); }
      .sv-t { color: var(--teal); text-shadow: 0 0 18px rgba(45, 212, 191, 0.5); }
      .sv-s { color: var(--seafoam); text-shadow: 0 0 18px rgba(94, 234, 212, 0.5); }
      .sc-unit { font-size: 13px; font-weight: 400; }
      .sc-sub { font-size: 8px; color: var(--text-mid); margin-top: 3px; }

      /* bars */
      .bar-w { margin-top: 7px; height: 3px; background: rgba(255, 255, 255, 0.04); border-radius: 2px; overflow: visible; position: relative; }
      .bar { height: 100%; border-radius: 2px; position: relative; transition: width 1s ease; }
      .bar::after {
        content: ""; position: absolute; right: -2px; top: -4px;
        width: 6px; height: 10px; border-radius: 3px;
        background: currentColor; filter: blur(2px); opacity: 0.9;
      }
      .b-b { background: linear-gradient(90deg, rgba(56, 189, 248, 0.15), var(--blue)); color: var(--blue); }
      .b-t { background: linear-gradient(90deg, rgba(45, 212, 191, 0.15), var(--teal)); color: var(--teal); }
      .b-s { background: linear-gradient(90deg, rgba(94, 234, 212, 0.15), var(--seafoam)); color: var(--seafoam); }
      .b-w { background: linear-gradient(90deg, rgba(239, 68, 68, 0.15), #ef4444); color: #ef4444; }

      /* === NET === */
      .net-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; flex: 1; }
      .nc {
        background: rgba(56, 189, 248, 0.03); border: 1px solid var(--glass-border);
        border-radius: 4px; padding: 10px; text-align: center;
        display: flex; flex-direction: column; justify-content: center;
        transition: transform 0.2s;
      }
      .nc:hover { transform: scale(1.02); }
      .nc-lbl { font-size: 7px; letter-spacing: 3px; text-transform: uppercase; color: var(--text-dim); margin-bottom: 5px; }
      .nc-big { font-family: "Spectral", serif; font-size: 24px; line-height: 1; }
      .nc-unit { font-size: 10px; font-family: "Source Code Pro", monospace; }
      .nc-tot { font-size: 8px; color: var(--text-mid); margin-top: 3px; }

      /* === DISK === */
      .dsk-rows { display: flex; flex-direction: column; gap: 10px; flex: 1; justify-content: space-between; }
      .dsk-meta { display: flex; justify-content: space-between; margin-bottom: 4px; }
      .dsk-mn { font-size: 10px; color: var(--text); }
      .dsk-pct { font-size: 9px; font-weight: 600; }

      /* === SERVICES === */
      .svc-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 7px; flex: 1; align-content: center; }
      .svc {
        padding: 12px 6px; background: rgba(56, 189, 248, 0.03);
        border: 1px solid var(--glass-border); border-radius: 4px;
        text-decoration: none; display: block; text-align: center;
        transition: all 0.3s; position: relative; overflow: hidden;
      }
      .svc::after {
        content: ""; position: absolute; inset: 0;
        background: radial-gradient(circle at 50% 120%, rgba(56, 189, 248, 0.12), transparent 60%);
        opacity: 0; transition: opacity 0.3s;
      }
      .svc:hover { background: rgba(56, 189, 248, 0.08); border-color: var(--glass-border-hover); transform: translateY(-3px) scale(1.02); }
      .svc:hover::after { opacity: 1; }
      .svc-icon { font-size: 20px; margin-bottom: 3px; display: block; }
      .svc-name { font-size: 10px; color: var(--text); display: block; font-weight: 600; }
      .svc-cat { font-size: 7px; color: var(--text-dim); letter-spacing: 2px; text-transform: uppercase; margin-top: 2px; display: block; }

      /* === DOCKER === */
      .dc-list { display: flex; flex-direction: column; gap: 6px; flex: 1; justify-content: space-between; }
      .dc-item {
        display: grid; grid-template-columns: 7px 1fr auto; gap: 8px; align-items: center;
        padding: 7px 10px; background: rgba(56, 189, 248, 0.02);
        border: 1px solid var(--glass-border); border-radius: 4px; transition: background 0.2s;
      }
      .dc-item:hover { background: rgba(56, 189, 248, 0.06); }
      .dc-live { width: 7px; height: 7px; border-radius: 50%; background: var(--blue); box-shadow: 0 0 8px var(--blue); }
      .dc-off { width: 7px; height: 7px; border-radius: 50%; background: rgba(255, 255, 255, 0.15); }
      .dc-nm { font-size: 10px; color: var(--text); }
      .dc-img { font-size: 8px; color: var(--text-dim); margin-top: 1px; }
      .dc-port { font-size: 9px; color: var(--blue); }

      /* === PROCESSES === */
      .pr-list { display: flex; flex-direction: column; gap: 4px; flex: 1; }
      .span4 .pr-list { display: grid; grid-template-columns: 1fr 1fr; gap: 4px 14px; }
      .pr-item {
        display: grid; grid-template-columns: 1fr 42px 42px; align-items: center; gap: 8px;
        padding: 6px 10px; background: rgba(56, 189, 248, 0.02);
        border: 1px solid var(--glass-border); border-radius: 4px; transition: background 0.2s;
      }
      .pr-item:hover { background: rgba(56, 189, 248, 0.05); }
      .pr-nm { font-size: 10px; color: var(--text); }
      .pr-pid { font-size: 7px; color: var(--text-dim); margin-top: 1px; }
      .pr-stat { text-align: right; }
      .pr-sl { font-size: 6px; color: var(--text-dim); letter-spacing: 1px; text-transform: uppercase; }
      .pr-sv { font-size: 11px; font-weight: 600; }
      .pv-hi { color: var(--teal); }
      .pv-md { color: var(--seafoam); }
      .pv-ok { color: var(--blue); }

      .span2 { grid-column: span 2; }
      .span3 { grid-column: span 3; }
      .span4 { grid-column: span 4; }

      /* === MOBILE === */
      @media (max-width: 1024px) {
        main { grid-template-columns: repeat(2, 1fr); gap: 10px; padding: 16px 20px; }
        .span2 { grid-column: span 2; }
        .span3, .span4 { grid-column: span 2; }
        header { padding: 16px 20px 12px; flex-direction: column; align-items: flex-start; gap: 12px; }
        .pills { justify-content: flex-start; }
        .shard-5 { display: none; }
      }
      @media (max-width: 640px) {
        main { grid-template-columns: 1fr; gap: 10px; padding: 12px 14px; }
        .span2, .span3, .span4 { grid-column: span 1; }
        header { padding: 14px 14px 10px; }
        .logo-name { font-size: 28px; }
        .pills { gap: 4px; }
        .pill { font-size: 9px; padding: 3px 8px; }
        .stats-2x2 { grid-template-columns: 1fr 1fr; gap: 6px; }
        .sc-val { font-size: 26px; }
        .svc-grid { grid-template-columns: repeat(2, 1fr); }
        .net-2 { grid-template-columns: 1fr 1fr; gap: 6px; }
        .span4 .pr-list { grid-template-columns: 1fr; }
        .crystal-shard { display: none; }
        .drag-handle { opacity: 0.4; }
      }

      ::-webkit-scrollbar { width: 4px; }
      ::-webkit-scrollbar-track { background: transparent; }
      ::-webkit-scrollbar-thumb { background: rgba(56, 189, 248, 0.15); border-radius: 4px; }
    </style>
  </head>
  <body>
    <div class="cavern-bg">
      <div class="cave-blob cb1"></div>
      <div class="cave-blob cb2"></div>
      <div class="cave-blob cb3"></div>
      <div class="crystal-shard shard-1"></div>
      <div class="crystal-shard shard-2"></div>
      <div class="crystal-shard shard-3"></div>
      <div class="crystal-shard shard-4"></div>
      <div class="crystal-shard shard-5"></div>
      <div class="crystal-shard shard-6"></div>
    </div>
    <div class="crystal-container" id="crystalContainer"></div>

    <header>
      <div>
        <div class="logo-label">Crystal Cavern ‚Äî Private Cloud</div>
        <div class="logo-name">Homelab</div>
      </div>
      <div class="pills">
        <div class="pill"><div class="pill-dot pd-b"></div><span class="pill-label">raspberrypi.local</span></div>
        <div class="pill"><div class="pill-dot pd-b"></div><span class="pill-label">5 containers</span></div>
        <div class="pill"><div class="pill-dot pd-t"></div><span class="pill-label">Storage 89%</span></div>
        <div class="pill"><div class="pill-dot pd-w"></div><span class="pill-label">14d 3h up</span></div>
      </div>
    </header>

    <main id="panelGrid">
      <div class="card card-blue" draggable="true" data-panel="system">
        <div class="card-header">
          <span class="card-title-wrap"><span class="drag-handle"><span></span><span></span><span></span></span><span class="card-title">System</span></span>
          <span class="card-badge badge-b">Live</span>
        </div>
        <div class="card-body">
          <div class="stats-2x2">
            <div class="sc cg-b"><div class="sc-nm">CPU</div><div class="sc-val sv-b" id="cpuV">34<span class="sc-unit">%</span></div><div class="bar-w"><div class="bar b-b" id="cpuB" style="width: 34%"></div></div></div>
            <div class="sc cg-t"><div class="sc-nm">Memory</div><div class="sc-val sv-t" id="memV">67<span class="sc-unit">%</span></div><div class="bar-w"><div class="bar b-t" id="memB" style="width: 67%"></div></div></div>
            <div class="sc cg-s"><div class="sc-nm">Temp</div><div class="sc-val sv-s">52<span class="sc-unit">¬∞C</span></div><div class="bar-w"><div class="bar b-s" style="width: 52%"></div></div></div>
            <div class="sc cg-b"><div class="sc-nm">Processes</div><div class="sc-val sv-b">148</div><div class="sc-sub">running</div></div>
          </div>
        </div>
      </div>

      <div class="card card-teal" draggable="true" data-panel="network">
        <div class="card-header">
          <span class="card-title-wrap"><span class="drag-handle"><span></span><span></span><span></span></span><span class="card-title">Network</span></span>
          <span class="card-badge badge-t">eth0</span>
        </div>
        <div class="card-body">
          <div class="net-2">
            <div class="nc"><div class="nc-lbl">‚Üì Inbound</div><div class="nc-big" style="color: var(--blue)" id="rxV">1.24<span class="nc-unit"> MB/s</span></div><div class="nc-tot">248.3 GB total</div></div>
            <div class="nc"><div class="nc-lbl">‚Üë Outbound</div><div class="nc-big" style="color: var(--teal)" id="txV">0.38<span class="nc-unit"> MB/s</span></div><div class="nc-tot">89.1 GB total</div></div>
          </div>
          <div style="margin-top: 10px; border-top: 1px solid var(--glass-border); padding-top: 8px;">
            <div style="display: flex; justify-content: space-between; font-size: 9px; margin-bottom: 4px;"><span style="color: var(--blue)">eth0</span><span style="color: var(--text-dim)">192.168.1.42</span><span style="color: var(--text-mid)">1 Gbps</span></div>
            <div style="display: flex; justify-content: space-between; font-size: 9px;"><span style="color: var(--text-dim)">wlan0</span><span style="color: var(--text-dim)">‚Äî</span><span style="color: var(--teal)">Offline</span></div>
          </div>
        </div>
      </div>

      <div class="card card-blue span2" draggable="true" data-panel="storage">
        <div class="card-header">
          <span class="card-title-wrap"><span class="drag-handle"><span></span><span></span><span></span></span><span class="card-title">Storage</span></span>
          <span class="card-badge badge-b">5 Volumes</span>
        </div>
        <div class="card-body">
          <div class="dsk-rows">
            <div><div class="dsk-meta"><span class="dsk-mn">/</span><span class="dsk-pct" style="color: var(--blue)">38% ¬∑ 45.2/118 GB</span></div><div class="bar-w"><div class="bar b-b" style="width: 38%"></div></div></div>
            <div><div class="dsk-meta"><span class="dsk-mn">/boot</span><span class="dsk-pct" style="color: var(--blue)">18% ¬∑ 90/500 MB</span></div><div class="bar-w"><div class="bar b-b" style="width: 18%"></div></div></div>
            <div><div class="dsk-meta"><span class="dsk-mn">/boot/firmware</span><span class="dsk-pct" style="color: var(--blue)">12% ¬∑ 60/500 MB</span></div><div class="bar-w"><div class="bar b-b" style="width: 12%"></div></div></div>
            <div><div class="dsk-meta"><span class="dsk-mn" style="color: var(--teal)">/mnt/storage ‚ö†</span><span class="dsk-pct" style="color: var(--teal)">89% ¬∑ 892/1000 GB</span></div><div class="bar-w"><div class="bar b-w" style="width: 89%"></div></div></div>
            <div><div class="dsk-meta"><span class="dsk-mn">/mnt/backup</span><span class="dsk-pct" style="color: var(--seafoam)">54% ¬∑ 270/500 GB</span></div><div class="bar-w"><div class="bar b-s" style="width: 54%"></div></div></div>
          </div>
        </div>
      </div>

      <div class="card card-blue span2" draggable="true" data-panel="services">
        <div class="card-header">
          <span class="card-title-wrap"><span class="drag-handle"><span></span><span></span><span></span></span><span class="card-title">Services</span></span>
          <span class="card-badge badge-b">6 active</span>
        </div>
        <div class="card-body">
          <div class="svc-grid">
            <a class="svc" href="#"><span class="svc-icon">üè†</span><span class="svc-name">Home Assistant</span><span class="svc-cat">Home Auto</span></a>
            <a class="svc" href="#"><span class="svc-icon">üê≥</span><span class="svc-name">Portainer</span><span class="svc-cat">Infra</span></a>
            <a class="svc" href="#"><span class="svc-icon">üõ°Ô∏è</span><span class="svc-name">Pi-hole</span><span class="svc-cat">Network</span></a>
            <a class="svc" href="#"><span class="svc-icon">üìä</span><span class="svc-name">Grafana</span><span class="svc-cat">Monitor</span></a>
            <a class="svc" href="#"><span class="svc-icon">‚òÅÔ∏è</span><span class="svc-name">Nextcloud</span><span class="svc-cat">Storage</span></a>
            <a class="svc" href="#"><span class="svc-icon">üé¨</span><span class="svc-name">Jellyfin</span><span class="svc-cat">Media</span></a>
          </div>
        </div>
      </div>

      <div class="card card-blue span2" draggable="true" data-panel="containers">
        <div class="card-header">
          <span class="card-title-wrap"><span class="drag-handle"><span></span><span></span><span></span></span><span class="card-title">Containers</span></span>
          <span class="card-badge badge-b">5 running</span>
        </div>
        <div class="card-body">
          <div class="dc-list">
            <div class="dc-item"><div class="dc-live"></div><div><div class="dc-nm">nginx</div><div class="dc-img">nginx:latest</div></div><div class="dc-port">:80 :443</div></div>
            <div class="dc-item"><div class="dc-live"></div><div><div class="dc-nm">homeassistant</div><div class="dc-img">home-assistant:stable</div></div><div class="dc-port">:8123</div></div>
            <div class="dc-item"><div class="dc-live"></div><div><div class="dc-nm">pihole</div><div class="dc-img">pihole/pihole:latest</div></div><div class="dc-port">:53 :80</div></div>
            <div class="dc-item"><div class="dc-live"></div><div><div class="dc-nm">portainer</div><div class="dc-img">portainer-ce:latest</div></div><div class="dc-port">:9000</div></div>
            <div class="dc-item"><div class="dc-off"></div><div><div class="dc-nm" style="color: var(--teal)">grafana</div><div class="dc-img">grafana:latest</div></div><div class="dc-port" style="color: var(--text-dim)">stopped</div></div>
            <div class="dc-item"><div class="dc-live"></div><div><div class="dc-nm">influxdb</div><div class="dc-img">influxdb:latest</div></div><div class="dc-port">:8086</div></div>
          </div>
        </div>
      </div>

      <div class="card card-teal span4" draggable="true" data-panel="processes">
        <div class="card-header">
          <span class="card-title-wrap"><span class="drag-handle"><span></span><span></span><span></span></span><span class="card-title">Processes</span></span>
          <span class="card-badge badge-t">Top 6</span>
        </div>
        <div class="card-body">
          <div class="pr-list">
            <div class="pr-item"><div><div class="pr-nm">homeassistant</div><div class="pr-pid">PID 1247</div></div><div class="pr-stat"><div class="pr-sl">CPU</div><div class="pr-sv pv-hi">8.2%</div></div><div class="pr-stat"><div class="pr-sl">MEM</div><div class="pr-sv pv-md">12.4%</div></div></div>
            <div class="pr-item"><div><div class="pr-nm">node</div><div class="pr-pid">PID 892</div></div><div class="pr-stat"><div class="pr-sl">CPU</div><div class="pr-sv pv-md">4.1%</div></div><div class="pr-stat"><div class="pr-sl">MEM</div><div class="pr-sv pv-ok">5.8%</div></div></div>
            <div class="pr-item"><div><div class="pr-nm">python3</div><div class="pr-pid">PID 1455</div></div><div class="pr-stat"><div class="pr-sl">CPU</div><div class="pr-sv pv-ok">2.8%</div></div><div class="pr-stat"><div class="pr-sl">MEM</div><div class="pr-sv pv-ok">3.2%</div></div></div>
            <div class="pr-item"><div><div class="pr-nm">influxd</div><div class="pr-pid">PID 743</div></div><div class="pr-stat"><div class="pr-sl">CPU</div><div class="pr-sv pv-ok">1.9%</div></div><div class="pr-stat"><div class="pr-sl">MEM</div><div class="pr-sv pv-ok">4.1%</div></div></div>
            <div class="pr-item"><div><div class="pr-nm">nginx</div><div class="pr-pid">PID 412</div></div><div class="pr-stat"><div class="pr-sl">CPU</div><div class="pr-sv pv-ok">0.3%</div></div><div class="pr-stat"><div class="pr-sl">MEM</div><div class="pr-sv pv-ok">0.8%</div></div></div>
            <div class="pr-item"><div><div class="pr-nm">pihole-FTL</div><div class="pr-pid">PID 321</div></div><div class="pr-stat"><div class="pr-sl">CPU</div><div class="pr-sv pv-ok">0.2%</div></div><div class="pr-stat"><div class="pr-sl">MEM</div><div class="pr-sv pv-ok">1.1%</div></div></div>
          </div>
        </div>
      </div>
    </main>

    <script>
      // === FLOATING CRYSTAL PARTICLES ===
      (function () {
        const container = document.getElementById("crystalContainer");
        const colors = [
          "rgba(56,189,248,0.5)",
          "rgba(45,212,191,0.4)",
          "rgba(94,234,212,0.4)",
          "rgba(240,240,255,0.3)",
        ];
        for (let i = 0; i < 12; i++) {
          const c = document.createElement("div");
          c.className = "crystal-particle";
          const sz = 8 + Math.random() * 8;
          const color = colors[Math.floor(Math.random() * colors.length)];
          const ypos = 5 + Math.random() * 90;
          c.style.cssText = `
            top:${ypos}%; width:${sz}px; height:${sz}px;
            background:${color}; box-shadow:0 0 ${sz}px ${color};
            transform:rotate(45deg);
            animation-duration:${20 + Math.random() * 20}s;
            animation-delay:${-Math.random() * 40}s;
            --yoff:${ypos}vh; --ydrift:${(Math.random() - 0.5) * 60}px;
          `;
          container.appendChild(c);
        }
      })();

      // === LIVE DATA ===
      setInterval(() => {
        const cpu = Math.max(8, Math.min(90, 34 + (Math.random() - 0.5) * 22));
        const mem = Math.max(55, Math.min(85, 67 + (Math.random() - 0.5) * 8));
        document.getElementById("cpuV").innerHTML = cpu.toFixed(0) + '<span class="sc-unit">%</span>';
        document.getElementById("cpuB").style.width = cpu + "%";
        document.getElementById("memV").innerHTML = mem.toFixed(0) + '<span class="sc-unit">%</span>';
        document.getElementById("memB").style.width = mem + "%";
        const rx = (Math.random() * 3.5).toFixed(2), tx = (Math.random() * 1.1).toFixed(2);
        document.getElementById("rxV").innerHTML = rx + '<span class="nc-unit"> MB/s</span>';
        document.getElementById("txV").innerHTML = tx + '<span class="nc-unit"> MB/s</span>';
      }, 3000);

      // === DRAG AND DROP PANEL REARRANGING ===
      (function () {
        const grid = document.getElementById("panelGrid");
        const STORAGE_KEY = "crystalCavern_panelOrder";
        let dragSrcEl = null;
        let ghost = null;
        let touchStartY = 0;
        let touchStartX = 0;
        let isDraggingTouch = false;
        let touchCurrentTarget = null;

        // Restore saved order on load
        function restoreOrder() {
          const saved = localStorage.getItem(STORAGE_KEY);
          if (!saved) return;
          try {
            const order = JSON.parse(saved);
            const cards = Array.from(grid.querySelectorAll(".card[data-panel]"));
            const cardMap = {};
            cards.forEach(c => { cardMap[c.dataset.panel] = c; });
            order.forEach(panelId => {
              if (cardMap[panelId]) {
                grid.appendChild(cardMap[panelId]);
              }
            });
          } catch (e) { /* ignore corrupt data */ }
        }

        function saveOrder() {
          const cards = Array.from(grid.querySelectorAll(".card[data-panel]"));
          const order = cards.map(c => c.dataset.panel);
          localStorage.setItem(STORAGE_KEY, JSON.stringify(order));
        }

        function getCardFromEvent(e) {
          const el = document.elementFromPoint(
            e.touches ? e.touches[0].clientX : e.clientX,
            e.touches ? e.touches[0].clientY : e.clientY
          );
          return el ? el.closest(".card[data-panel]") : null;
        }

        // === DESKTOP: HTML5 Drag and Drop ===
        grid.addEventListener("dragstart", function (e) {
          const card = e.target.closest(".card[data-panel]");
          if (!card) return;
          // Only allow drag from header area
          const header = card.querySelector(".card-header");
          const rect = header.getBoundingClientRect();
          if (e.clientY > rect.bottom) { e.preventDefault(); return; }

          dragSrcEl = card;
          card.classList.add("dragging");
          e.dataTransfer.effectAllowed = "move";
          e.dataTransfer.setData("text/plain", card.dataset.panel);

          // Create minimal drag image
          const img = document.createElement("div");
          img.style.width = "1px";
          img.style.height = "1px";
          document.body.appendChild(img);
          e.dataTransfer.setDragImage(img, 0, 0);
          setTimeout(() => document.body.removeChild(img), 0);
        });

        grid.addEventListener("dragover", function (e) {
          e.preventDefault();
          e.dataTransfer.dropEffect = "move";
          const target = getCardFromEvent(e);
          // Clear all drag-over states
          grid.querySelectorAll(".drag-over").forEach(c => c.classList.remove("drag-over"));
          if (target && target !== dragSrcEl) {
            target.classList.add("drag-over");
          }
        });

        grid.addEventListener("dragleave", function (e) {
          const target = e.target.closest(".card[data-panel]");
          if (target) target.classList.remove("drag-over");
        });

        grid.addEventListener("drop", function (e) {
          e.preventDefault();
          const target = getCardFromEvent(e);
          grid.querySelectorAll(".drag-over").forEach(c => c.classList.remove("drag-over"));

          if (target && dragSrcEl && target !== dragSrcEl) {
            // Determine position: insert before or after target
            const cards = Array.from(grid.querySelectorAll(".card[data-panel]"));
            const srcIdx = cards.indexOf(dragSrcEl);
            const tgtIdx = cards.indexOf(target);
            if (srcIdx < tgtIdx) {
              target.after(dragSrcEl);
            } else {
              target.before(dragSrcEl);
            }
            saveOrder();
          }
        });

        grid.addEventListener("dragend", function () {
          if (dragSrcEl) {
            dragSrcEl.classList.remove("dragging");
            dragSrcEl = null;
          }
          grid.querySelectorAll(".drag-over").forEach(c => c.classList.remove("drag-over"));
        });

        // === MOBILE: Touch-based drag ===
        grid.addEventListener("touchstart", function (e) {
          const card = e.target.closest(".card[data-panel]");
          if (!card) return;
          const header = card.querySelector(".card-header");
          const rect = header.getBoundingClientRect();
          const touch = e.touches[0];
          if (touch.clientY > rect.bottom) return;

          touchStartX = touch.clientX;
          touchStartY = touch.clientY;
          dragSrcEl = card;
          isDraggingTouch = false;
        }, { passive: true });

        grid.addEventListener("touchmove", function (e) {
          if (!dragSrcEl) return;
          const touch = e.touches[0];
          const dx = touch.clientX - touchStartX;
          const dy = touch.clientY - touchStartY;

          // Require minimum movement to start drag
          if (!isDraggingTouch && Math.sqrt(dx * dx + dy * dy) < 15) return;

          if (!isDraggingTouch) {
            isDraggingTouch = true;
            dragSrcEl.classList.add("dragging");

            // Create ghost
            ghost = dragSrcEl.cloneNode(true);
            ghost.classList.add("drag-ghost");
            ghost.classList.remove("dragging");
            ghost.style.width = dragSrcEl.offsetWidth + "px";
            ghost.style.height = dragSrcEl.offsetHeight + "px";
            document.body.appendChild(ghost);
          }

          e.preventDefault();

          // Position ghost
          if (ghost) {
            ghost.style.left = (touch.clientX - dragSrcEl.offsetWidth / 2) + "px";
            ghost.style.top = (touch.clientY - 30) + "px";
          }

          // Highlight drop target
          grid.querySelectorAll(".drag-over").forEach(c => c.classList.remove("drag-over"));
          const elemBelow = document.elementFromPoint(touch.clientX, touch.clientY);
          const targetCard = elemBelow ? elemBelow.closest(".card[data-panel]") : null;
          if (targetCard && targetCard !== dragSrcEl) {
            targetCard.classList.add("drag-over");
            touchCurrentTarget = targetCard;
          } else {
            touchCurrentTarget = null;
          }

          // Auto-scroll when near edges
          const scrollThreshold = 60;
          if (touch.clientY < scrollThreshold) {
            window.scrollBy(0, -8);
          } else if (touch.clientY > window.innerHeight - scrollThreshold) {
            window.scrollBy(0, 8);
          }
        }, { passive: false });

        grid.addEventListener("touchend", function () {
          if (isDraggingTouch && dragSrcEl && touchCurrentTarget) {
            const cards = Array.from(grid.querySelectorAll(".card[data-panel]"));
            const srcIdx = cards.indexOf(dragSrcEl);
            const tgtIdx = cards.indexOf(touchCurrentTarget);
            if (srcIdx < tgtIdx) {
              touchCurrentTarget.after(dragSrcEl);
            } else {
              touchCurrentTarget.before(dragSrcEl);
            }
            saveOrder();
          }

          // Cleanup
          if (dragSrcEl) dragSrcEl.classList.remove("dragging");
          grid.querySelectorAll(".drag-over").forEach(c => c.classList.remove("drag-over"));
          if (ghost) { ghost.remove(); ghost = null; }
          dragSrcEl = null;
          isDraggingTouch = false;
          touchCurrentTarget = null;
        });

        // Restore order on page load
        restoreOrder();
      })();
    </script>
  </body>
</html>
